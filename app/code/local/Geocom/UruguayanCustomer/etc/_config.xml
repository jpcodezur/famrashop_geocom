<?xml version="1.0"?>
<config>
    <modules>
        <Geocom_UruguayanCustomer>
            <version>0.2.1</version>
        </Geocom_UruguayanCustomer>
    </modules>
    <frontend>
        <routers>
            <uruguayancustomer>
                <use>standard</use>
                <args>
                    <module>Geocom_UruguayanCustomer</module>
                    <frontName>uruguayancustomer</frontName>
                </args>
            </uruguayancustomer>
            <customer>
                <args>
                    <modules>
                        <!--<uruguayancustomer before="Mage_Customer">Geocom_UruguayanCustomer</uruguayancustomer>-->
                        <uruguayancustomer before="Cualit_UruguayanCustomer">Geocom_UruguayanCustomer</uruguayancustomer>
                    </modules>
                </args>
            </customer>
        </routers>
        <layout>
            <updates>
                <uruguayancustomer module="UruguayanCustomer">
                    <file>uruguayancustomergeocom.xml</file>
                </uruguayancustomer>
            </updates>
        </layout>
    </frontend>
    <global>
        <events>
            <customer_logout>
                <observers>
                    <unset_customer_session_when_callcenter>
                        <type>singleton</type>
                        <class>Geocom_UruguayanCustomer_Model_Observer</class>
                        <method>unsetCustomerSessionDataWhenCC</method>
                    </unset_customer_session_when_callcenter>
                </observers>
            </customer_logout>
            <sales_quote_collect_totals_after>
                <observers>
                    <set_custom_discount>
                        <type>singleton</type>
                        <class>Geocom_UruguayanCustomer_Model_Observer</class>
                        <method>setPointsDiscount</method>
                    </set_custom_discount>
                </observers>
            </sales_quote_collect_totals_after>
            <sales_order_save_before> <!-- Event called after Order Object is saved -->
                <observers>
                    <sales_order_load_after>
                        <type>singleton</type>
                        <class>Geocom_UruguayanCustomer_Model_Observer</class> <!-- Over Model Class -->
                        <method>saveOrderBefore</method> <!-- name of function -->
                    </sales_order_load_after>
                </observers>
            </sales_order_save_before>
        </events>
        <blocks>
            <checkout>
                <rewrite>
                    <onepage>Geocom_UruguayanCustomer_Block_Onepage</onepage>
                </rewrite>
            </checkout>
            <page>
                <rewrite>
                    <html_header>Geocom_UruguayanCustomer_Block_Page_Html_Header</html_header>
                </rewrite>
            </page>
            <customer>
                <rewrite>
                    <form_edit>Geocom_UruguayanCustomer_Block_Form_Edit</form_edit>
                </rewrite>
                <rewrite>
                    <account_dashboard_address>Geocom_UruguayanCustomer_Block_Account_Dashboard_Address</account_dashboard_address>
                </rewrite>
            </customer>
            <uruguayancustomer>
                <class>Geocom_UruguayanCustomer_Block</class>
            </uruguayancustomer>
        </blocks>
        <rewrite>
            <geocom_uruguayancustomer_customer_accountcontroller>
                <from><![CDATA[#^/customer/account/#]]></from>
                <!-- Mage_Customer_AccountController  -->
                <to>/uruguayancustomer/customer_account/</to>
                <!-- Geocom_UruguayanCustomer_Customer_AccountController  -->
            </geocom_uruguayancustomer_customer_accountcontroller>
            <geocom_uruguayancustomer_checkout_onepagecontroller>
                <from><![CDATA[#^/checkout/onepage/#]]></from>
                <!-- Mage_Checkout_OnePageController  -->
                <to>/uruguayancustomer/checkout_onepage/</to>
                <!-- Geocom_UruguayanCustomer_Checkout_OnePageController  -->
            </geocom_uruguayancustomer_checkout_onepagecontroller>
        </rewrite>
        <helpers>
            <uruguayancustomer>
                <class>Geocom_UruguayanCustomer_Helper</class>
            </uruguayancustomer>
        </helpers>
        <models>
            <uruguayancustomer>
                <class>Geocom_UruguayanCustomer_Model</class>
                <resourceModel>uruguayancustomer_mysql4</resourceModel>
            </uruguayancustomer>
            <admin>
                <rewrite>
                    <observer>Geocom_UruguayanCustomer_Model_Admin_Observer</observer>
                    <session>Geocom_UruguayanCustomer_Model_Admin_Session</session>
                </rewrite>
            </admin>
            <Customer>
                <rewrite>
                    <!-- Model -->
                    <tag>Geocom_UruguayanCustomer_Model_Customer</tag>
                </rewrite>
            </Customer>
            <checkout>
                <rewrite>
                    <type_onepage>Geocom_UruguayanCustomer_Model_Type_Onepage</type_onepage>
                </rewrite>
            </checkout>
            <sales>
                <rewrite>
                    <order_pdf_invoice>Geocom_UruguayanCustomer_Invoice_Model_Order_Pdf_Invoice</order_pdf_invoice>
                </rewrite>
            </sales>
        </models>
        <resources>
            <customerattribute1410964117_setup>
                <setup>
                    <module>Geocom_UruguayanCustomer</module>
                    <class>Mage_Customer_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </customerattribute1410964117_setup>
            <customerattribute1410964117_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </customerattribute1410964117_write>
            <customerattribute1410964117_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </customerattribute1410964117_read>
        </resources>
        <fieldsets>
            <checkout_onepage_quote>
                <rut_buyer>
                    <to_customer>rut_buyer</to_customer>
                </rut_buyer>
                <rut_number>
                    <to_customer>rut_number</to_customer>
                </rut_number>
                <customer_document_number>
                    <to_customer>document_number</to_customer>
                </customer_document_number>
                <customer_document_type>
                    <to_customer>document_type</to_customer>
                </customer_document_type>
            </checkout_onepage_quote>
            <customer_account>
                <document_number>
                    <to_quote>customer_document_number</to_quote>
                </document_number>
                <document_type>
                    <to_quote>customer_document_type</to_quote>
                </document_type>
            </customer_account>
            <customer_account>
                <document_number>
                    <to_order>customer_document_number</to_order>
                </document_number>
                <document_type>
                    <to_order>customer_document_type</to_order>
                </document_type>
            </customer_account>
            <checkout_onepage_billing>
                <document_number>
                    <to_customer>*</to_customer>
                </document_number>
                <document_type>
                    <to_customer>*</to_customer>
                </document_type>
            </checkout_onepage_billing>
            <sales_convert_order>
                <position_json>
                    <to_quote>*</to_quote>
                </position_json>
                <comment>
                    <to_quote>*</to_quote>
                </comment>
                <rut_buyer>
                    <to_quote>*</to_quote>
                </rut_buyer>
                <rut_number>
                    <to_quote>*</to_quote>
                </rut_number>
                <customer_document_number>
                    <to_quote>*</to_quote>
                </customer_document_number>
                <customer_document_type>
                    <to_quote>*</to_quote>
                </customer_document_type>
                <contexto_promocion>
                    <to_quote>*</to_quote>
                </contexto_promocion>
                <geo_region_id>
                    <to_quote>*</to_quote>
                </geo_region_id>
                <city_id>
                    <to_quote>*</to_quote>
                </city_id>
                <neighborhood_id>
                    <to_quote>*</to_quote>
                </neighborhood_id>
            </sales_convert_order>
            <sales_convert_quote>
                <contexto_promocion>
                    <to_order>*</to_order>
                </contexto_promocion>
                <puntos_canjeados>
                    <to_order>*</to_order>
                </puntos_canjeados>
                <delivery_to>
                    <to_order>*</to_order>
                </delivery_to>
                <delivery_from>
                    <to_order>*</to_order>
                </delivery_from>
                <position_json>
                    <to_order>*</to_order>
                </position_json>
                <comment>
                    <to_order>*</to_order>
                </comment>
                <rut_buyer>
                    <to_order>*</to_order>
                </rut_buyer>
                <rut_number>
                    <to_order>*</to_order>
                </rut_number>
                <customer_document_number>
                    <to_order>*</to_order>
                </customer_document_number>
                <customer_document_type>
                    <to_order>*</to_order>
                </customer_document_type>
            </sales_convert_quote>
            <sales_copy_order_billing_address>
                <position_json>
                    <to_order>*</to_order>
                </position_json>
                <neighborhood>
                    <to_order>*</to_order>
                </neighborhood>
                <neighborhood_id>
                    <to_order>*</to_order>
                </neighborhood_id>
                <address_number>
                    <to_order>*</to_order>
                </address_number>
                <address_corner>
                    <to_order>*</to_order>
                </address_corner>
                <complement>
                    <to_order>*</to_order>
                </complement>
                <geo_region_id>
                    <to_order>*</to_order>
                </geo_region_id>
                <city_id>
                    <to_order>*</to_order>
                </city_id>
            </sales_copy_order_billing_address>
            <sales_copy_order_shipping_address>
                <position_json>
                    <to_order>*</to_order>
                </position_json>
                <neighborhood>
                    <to_order>*</to_order>
                </neighborhood>
                <neighborhood_id>
                    <to_order>*</to_order>
                </neighborhood_id>
                <address_number>
                    <to_order>*</to_order>
                </address_number>
                <address_corner>
                    <to_order>*</to_order>
                </address_corner>
                <complement>
                    <to_order>*</to_order>
                </complement>
                <geo_region_id>
                    <to_order>*</to_order>
                </geo_region_id>
                <city_id>
                    <to_order>*</to_order>
                </city_id>

            </sales_copy_order_shipping_address>
            <sales_convert_quote_address>
                <position_json>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </position_json>
                <neighborhood>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </neighborhood>
                <neighborhood_id>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </neighborhood_id>
                <address_number>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </address_number>
                <address_corner>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </address_corner>
                <complement>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </complement>
                <geo_region_id>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </geo_region_id>
                <city_id>
                    <to_order_address>*</to_order_address>
                    <to_customer_address>*</to_customer_address>
                </city_id>
            </sales_convert_quote_address>
            <sales_convert_order_address>
                <complement>
                    <to_quote_address>*</to_quote_address>
                </complement>
                <position_json>
                    <to_quote_address>*</to_quote_address>
                </position_json>
                <neighborhood>
                    <to_quote_address>*</to_quote_address>
                </neighborhood>
                <neighborhood_id>
                    <to_quote_address>*</to_quote_address>
                </neighborhood_id>
                <address_number>
                    <to_quote_address>*</to_quote_address>
                </address_number>
                <address_corner>
                    <to_quote_address>*</to_quote_address>
                </address_corner>
                <geo_region_id>
                    <to_quote_address>*</to_quote_address>
                </geo_region_id>
                <city_id>
                    <to_quote_address>*</to_quote_address>
                </city_id>
            </sales_convert_order_address>
            <customer_address>
                <position_json>
                    <to_quote_address>*</to_quote_address>
                </position_json>
                <neighborhood>
                    <to_quote_address>*</to_quote_address>
                </neighborhood>
                <neighborhood_id>
                    <to_quote_address>*</to_quote_address>
                </neighborhood_id>
                <address_number>
                    <to_quote_address>*</to_quote_address>
                </address_number>
                <address_corner>
                    <to_quote_address>*</to_quote_address>
                </address_corner>
                <complement>
                    <to_quote_address>*</to_quote_address>
                </complement>
                <geo_region_id>
                    <to_quote_address>*</to_quote_address>
                </geo_region_id>
                <city_id>
                    <to_quote_address>*</to_quote_address>
                </city_id>
            </customer_address>
            <checkout_onepage_billing>
                <complement><to_customer>*</to_customer></complement>
                <position_json>
                    <to_customer>*</to_customer>
                </position_json>
                <neighborhood>
                    <to_customer>*</to_customer>
                </neighborhood>
                <neighborhood_id>
                    <to_customer>*</to_customer>
                </neighborhood_id>
                <address_number>
                    <to_customer>*</to_customer>
                </address_number>
                <address_corner>
                    <to_customer>*</to_customer>
                </address_corner>
            </checkout_onepage_billing>
        </fieldsets>
    </global>
    <admin>
        <routers>
            <uruguayancustomer>
                <use>admin</use>
                <args>
                    <module>Geocom_UruguayanCustomer</module>
                    <frontName>admin_uruguayancustomer</frontName>
                </args>
            </uruguayancustomer>
        </routers>
        <fieldsets>
            <customer_dataflow>
                <neighborhood>
                    <billing>1</billing>
                    <shipping>1</shipping>
                </neighborhood>
                <neighborhood_id>
                    <billing>1</billing>
                    <shipping>1</shipping>
                </neighborhood_id>
                <addres_number>
                    <billing>1</billing>
                    <shipping>1</shipping>
                </addres_number>
                <addres_corner>
                    <billing>1</billing>
                    <shipping>1</shipping>
                </addres_corner>
                <complement>
                    <billing>1</billing>
                    <shipping>1</shipping>
                </complement>
            </customer_dataflow>
        </fieldsets>
    </admin>
</config> 